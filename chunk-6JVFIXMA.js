import{a as _e,b as Ce,c as ve,d as ge,e as xe,f as Pe,g as Se,h as Me,i as be,j as Ee,k as Ie,l as ye,m as Te}from"./chunk-AWLMKVGE.js";import"./chunk-LJLSRGT3.js";import{a as ce,b as pe,e as ue,f as de,g as he,h as fe}from"./chunk-ZMTNKF2C.js";import{a as Y,b as v,d as Z,e as ee,h as te,i as ie,j as re,k as ae,m as ne,n as oe,o as me,q as le,r as I,s as se,t as y}from"./chunk-JLC34J6X.js";import"./chunk-Q64FFBLU.js";import{a as b,b as E}from"./chunk-M4UNVSQS.js";import{a as T,b as w,e as D}from"./chunk-KT3WS7J5.js";import{a as K,ba as X,g as W,i as M}from"./chunk-HS7PEKAI.js";import{Bb as C,Db as g,Lb as a,Mb as d,Nb as U,Ra as l,Sa as h,Sb as P,Tb as R,Vb as q,X as B,aa as H,ga as x,hb as c,jb as s,oa as L,pa as N,sb as r,tb as i,ub as u,uc as z,vb as f,wb as _,wc as Q,yb as G,yc as J,zc as S}from"./chunk-Y5R3IJQL.js";import{a as j}from"./chunk-CWTPBX7D.js";var F=(()=>{class e{constructor(t){this.http=t,this.apiUrl="http://localhost:8082/api/purchases"}getPurchases(){return this.http.get(this.apiUrl)}getPurchase(t){return this.http.get(`${this.apiUrl}/${t}`)}createPurchase(t){return this.http.post(this.apiUrl,t)}updatePurchase(t,n){return this.http.put(`${this.apiUrl}/${t}`,n)}deletePurchase(t){return this.http.delete(`${this.apiUrl}/${t}`)}static{this.\u0275fac=function(n){return new(n||e)(H(K))}}static{this.\u0275prov=B({token:e,factory:e.\u0275fac,providedIn:"root"})}}return e})();function Ae(e,m){e&1&&(r(0,"th",14),a(1,"No. Compra"),i())}function $e(e,m){if(e&1&&(r(0,"td",15),a(1),i()),e&2){let t=m.$implicit;l(),d(t.number)}}function Oe(e,m){e&1&&(r(0,"th",14),a(1,"Fecha"),i())}function Ve(e,m){if(e&1&&(r(0,"td",15),a(1),R(2,"date"),i()),e&2){let t=m.$implicit;l(),d(q(2,1,t.date,"shortDate"))}}function je(e,m){e&1&&(r(0,"th",14),a(1,"Proveedor"),i())}function Be(e,m){if(e&1&&(r(0,"td",15),a(1),i()),e&2){let t=m.$implicit;l(),d(t.supplier==null?null:t.supplier.name)}}function He(e,m){e&1&&(r(0,"th",14),a(1,"Total"),i())}function Ge(e,m){if(e&1&&(r(0,"td",15),a(1),R(2,"currency"),i()),e&2){let t=m.$implicit;l(),d(q(2,1,t.total,"GTQ"))}}function Ue(e,m){e&1&&(r(0,"th",14),a(1,"Activo"),i())}function ze(e,m){if(e&1&&(r(0,"td",15)(1,"mat-icon",16),a(2),i()()),e&2){let t=m.$implicit;l(2),d(t.isActive?"check_circle":"cancel")}}function Qe(e,m){e&1&&(r(0,"th",14),a(1,"Acciones"),i())}function Je(e,m){if(e&1){let t=G();r(0,"td",15)(1,"button",17),C("click",function(){let o=L(t).$implicit,p=g();return N(p.editPurchase(o))}),r(2,"mat-icon"),a(3,"edit"),i()(),r(4,"button",18),C("click",function(){let o=L(t).$implicit,p=g();return N(p.deletePurchase(o))}),r(5,"mat-icon"),a(6,"delete"),i()()()}}function Ke(e,m){e&1&&u(0,"tr",19)}function We(e,m){e&1&&u(0,"tr",20)}var Fe=(()=>{class e{constructor(t,n){this.purchaseService=t,this.router=n,this.purchases=[],this.displayedColumns=["number","date","supplier","total","isActive","actions"]}ngOnInit(){this.loadPurchases()}loadPurchases(){this.purchaseService.getPurchases().subscribe(t=>this.purchases=t)}addPurchase(){this.router.navigate(["purchases","nuevo"])}editPurchase(t){this.router.navigate(["purchases","editar",t.id])}deletePurchase(t){confirm("\xBFSeguro que deseas eliminar esta compra?")&&this.purchaseService.deletePurchase(t.id).subscribe(()=>this.loadPurchases())}static{this.\u0275fac=function(n){return new(n||e)(h(F),h(M))}}static{this.\u0275cmp=x({type:e,selectors:[["app-purchase-list"]],standalone:!0,features:[P],decls:32,vars:3,consts:[[1,"spacer"],["mat-raised-button","","color","primary",3,"click"],[1,"table-container"],["mat-table","",1,"mat-elevation-z8",3,"dataSource"],["matColumnDef","number"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","date"],["matColumnDef","supplier"],["matColumnDef","total"],["matColumnDef","isActive"],["matColumnDef","actions"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["mat-header-cell",""],["mat-cell",""],["color","primary"],["mat-icon-button","","color","primary",3,"click"],["mat-icon-button","","color","warn",3,"click"],["mat-header-row",""],["mat-row",""]],template:function(n,o){n&1&&(r(0,"mat-card")(1,"mat-card-title")(2,"mat-icon"),a(3,"shopping_cart"),i(),a(4," Compras "),u(5,"span",0),r(6,"button",1),C("click",function(){return o.addPurchase()}),r(7,"mat-icon"),a(8,"add"),i(),a(9," Nueva "),i()(),r(10,"div",2)(11,"table",3),f(12,4),c(13,Ae,2,0,"th",5)(14,$e,2,1,"td",6),_(),f(15,7),c(16,Oe,2,0,"th",5)(17,Ve,3,4,"td",6),_(),f(18,8),c(19,je,2,0,"th",5)(20,Be,2,1,"td",6),_(),f(21,9),c(22,He,2,0,"th",5)(23,Ge,3,4,"td",6),_(),f(24,10),c(25,Ue,2,0,"th",5)(26,ze,3,1,"td",6),_(),f(27,11),c(28,Qe,2,0,"th",5)(29,Je,7,0,"td",6),_(),c(30,Ke,1,0,"tr",12)(31,We,1,0,"tr",13),i()()()),n&2&&(l(11),s("dataSource",o.purchases),l(19),s("matHeaderRowDef",o.displayedColumns),l(),s("matRowDefColumns",o.displayedColumns))},dependencies:[S,J,Q,Ie,_e,ve,Se,ge,Ce,Me,xe,Pe,be,Ee,D,T,w,E,b,y,I,se],styles:[".table-container[_ngcontent-%COMP%]{overflow-x:auto;margin-top:1rem}table[_ngcontent-%COMP%]{width:100%;min-width:400px}mat-card[_ngcontent-%COMP%]{margin:2rem auto;max-width:900px}mat-card-title[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.5rem;font-size:1.5rem}.spacer[_ngcontent-%COMP%]{flex:1 1 auto}"]})}}return e})();function Xe(e,m){e&1&&(r(0,"mat-error"),a(1,"Requerido"),i())}function Ye(e,m){e&1&&(r(0,"mat-error"),a(1,"Requerido"),i())}function Ze(e,m){e&1&&(r(0,"mat-error"),a(1,"Requerido"),i())}function et(e,m){e&1&&(r(0,"mat-error"),a(1,"Requerido"),i())}function tt(e,m){e&1&&(r(0,"mat-error"),a(1,"No puede ser negativo"),i())}function it(e,m){if(e&1&&(r(0,"mat-error"),a(1),i()),e&2){let t=g();l(),d(t.error)}}var k=(()=>{class e{constructor(t,n,o,p){this.fb=t,this.purchaseService=n,this.route=o,this.router=p,this.isEdit=!1,this.purchaseId=null,this.loading=!1,this.error=null,this.form=this.fb.group({number:["",[v.required]],date:["",[v.required]],supplier:["",[v.required]],total:[0,[v.required,v.min(0)]],isActive:[!0]})}ngOnInit(){let t=this.route.snapshot.paramMap.get("id");t?(this.isEdit=!0,this.purchaseId=+t,this.loading=!0,this.purchaseService.getPurchase(this.purchaseId).subscribe({next:n=>{this.form.patchValue({number:n.number,date:n.date,supplier:n.supplier,total:n.total,isActive:n.isActive}),this.loading=!1},error:n=>{this.error="No se pudo cargar la compra",this.loading=!1}})):this.isEdit=!1}save(){if(this.form.invalid)return;this.loading=!0;let t=j({},this.form.value);this.isEdit&&this.purchaseId?this.purchaseService.updatePurchase(this.purchaseId,t).subscribe({next:()=>this.router.navigate(["/purchases"]),error:n=>{this.error="Error al actualizar compra",this.loading=!1}}):this.purchaseService.createPurchase(t).subscribe({next:()=>this.router.navigate(["/purchases"]),error:n=>{this.error="Error al crear compra",this.loading=!1}})}cancel(){this.router.navigate(["/purchases"])}static{this.\u0275fac=function(n){return new(n||e)(h(me),h(F),h(W),h(M))}}static{this.\u0275cmp=x({type:e,selectors:[["app-purchase-form"]],standalone:!0,features:[P],decls:43,vars:13,consts:[[3,"ngSubmit","formGroup"],["appearance","outline",1,"full-width"],["matInput","","formControlName","number","required",""],[4,"ngIf"],["matInput","","type","date","formControlName","date","required",""],["matInput","","formControlName","supplier","required",""],["matInput","","type","number","formControlName","total","required","","min","0"],["formControlName","isActive"],[3,"value"],[1,"actions"],["mat-raised-button","","color","primary","type","submit",3,"disabled"],["mat-button","","type","button",3,"click","disabled"]],template:function(n,o){if(n&1&&(r(0,"mat-card")(1,"mat-card-title")(2,"mat-icon"),a(3),i(),a(4),i(),r(5,"form",0),C("ngSubmit",function(){return o.save()}),r(6,"mat-form-field",1)(7,"mat-label"),a(8,"No. Compra"),i(),u(9,"input",2),c(10,Xe,2,0,"mat-error",3),i(),r(11,"mat-form-field",1)(12,"mat-label"),a(13,"Fecha"),i(),u(14,"input",4),c(15,Ye,2,0,"mat-error",3),i(),r(16,"mat-form-field",1)(17,"mat-label"),a(18,"Proveedor"),i(),u(19,"input",5),c(20,Ze,2,0,"mat-error",3),i(),r(21,"mat-form-field",1)(22,"mat-label"),a(23,"Total"),i(),u(24,"input",6),c(25,et,2,0,"mat-error",3)(26,tt,2,0,"mat-error",3),i(),r(27,"mat-form-field",1)(28,"mat-label"),a(29,"Activo"),i(),r(30,"mat-select",7)(31,"mat-option",8),a(32,"S\xED"),i(),r(33,"mat-option",8),a(34,"No"),i()()(),r(35,"div",9)(36,"button",10)(37,"mat-icon"),a(38,"save"),i(),a(39," Guardar "),i(),r(40,"button",11),C("click",function(){return o.cancel()}),a(41,"Cancelar"),i()(),c(42,it,2,1,"mat-error",3),i()()),n&2){let p,A,$,O,V;l(3),d(o.isEdit?"edit":"add"),l(),U(" ",o.isEdit?"Editar compra":"Nueva compra"," "),l(),s("formGroup",o.form),l(5),s("ngIf",(p=o.form.get("number"))==null?null:p.hasError("required")),l(5),s("ngIf",(A=o.form.get("date"))==null?null:A.hasError("required")),l(5),s("ngIf",($=o.form.get("supplier"))==null?null:$.hasError("required")),l(5),s("ngIf",(O=o.form.get("total"))==null?null:O.hasError("required")),l(),s("ngIf",(V=o.form.get("total"))==null?null:V.hasError("min")),l(5),s("value",!0),l(2),s("value",!1),l(3),s("disabled",o.form.invalid||o.loading),l(4),s("disabled",o.loading),l(2),s("ngIf",o.error)}},dependencies:[S,z,le,te,Y,ie,Z,ee,oe,ne,re,ae,D,T,w,de,ue,ce,pe,fe,he,y,I,E,b,Te,ye,X],styles:[".full-width[_ngcontent-%COMP%]{width:100%;margin-bottom:1rem}.actions[_ngcontent-%COMP%]{display:flex;gap:1rem;margin-top:1rem}mat-card[_ngcontent-%COMP%]{max-width:500px;margin:2rem auto}mat-card-title[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.5rem;font-size:1.3rem;margin-bottom:1rem}"]})}}return e})();var Dt=[{path:"",component:Fe},{path:"nuevo",component:k},{path:"editar/:id",component:k}];export{Dt as purchasesRoutes};
