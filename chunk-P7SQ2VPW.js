import{a as D}from"./chunk-ZCRNII25.js";import{a as me,b as le,c as se,d as de,e as ue,f as pe,g as ce,h as fe,i as _e,j as he,k as Ce,l as ve,m as ge}from"./chunk-AWLMKVGE.js";import"./chunk-LJLSRGT3.js";import{a as te,b as ie,e as re,f as ne,g as ae,h as oe}from"./chunk-ZMTNKF2C.js";import{a as G,b as v,d as z,e as J,h as K,j as Q,k as W,n as X,o as Y,q as Z,r as U,s as ee,t as w}from"./chunk-JLC34J6X.js";import"./chunk-Q64FFBLU.js";import{a as S,b}from"./chunk-M4UNVSQS.js";import{a as y,b as I,e as T}from"./chunk-KT3WS7J5.js";import{ba as $,g as B,i as M}from"./chunk-HS7PEKAI.js";import{Bb as _,Db as g,Lb as r,Mb as f,Nb as P,Ra as o,Sa as c,Sb as x,ga as E,hb as d,jb as s,oa as N,pa as F,sb as i,tb as t,ub as p,uc as H,vb as h,wb as C,yb as O,zc as j}from"./chunk-Y5R3IJQL.js";import{a as k}from"./chunk-CWTPBX7D.js";function ye(e,l){e&1&&(i(0,"th",13),r(1,"Usuario"),t())}function Ie(e,l){if(e&1&&(i(0,"td",14),r(1),t()),e&2){let n=l.$implicit;o(),f(n.username)}}function Te(e,l){e&1&&(i(0,"th",13),r(1,"Nombre"),t())}function De(e,l){if(e&1&&(i(0,"td",14),r(1),t()),e&2){let n=l.$implicit;o(),f(n.fullName)}}function Ne(e,l){e&1&&(i(0,"th",13),r(1,"Email"),t())}function Fe(e,l){if(e&1&&(i(0,"td",14),r(1),t()),e&2){let n=l.$implicit;o(),f(n.email)}}function qe(e,l){e&1&&(i(0,"th",13),r(1,"Activo"),t())}function Le(e,l){if(e&1&&(i(0,"td",14)(1,"mat-icon",15),r(2),t()()),e&2){let n=l.$implicit;o(2),f(n.isActive?"check_circle":"cancel")}}function Re(e,l){e&1&&(i(0,"th",13),r(1,"Acciones"),t())}function Ve(e,l){if(e&1){let n=O();i(0,"td",14)(1,"button",16),_("click",function(){let a=N(n).$implicit,u=g();return F(u.editUser(a))}),i(2,"mat-icon"),r(3,"edit"),t()(),i(4,"button",17),_("click",function(){let a=N(n).$implicit,u=g();return F(u.deleteUser(a))}),i(5,"mat-icon"),r(6,"delete"),t()()()}}function Ae(e,l){e&1&&p(0,"tr",18)}function ke(e,l){e&1&&p(0,"tr",19)}var Ee=(()=>{class e{constructor(n,m){this.userService=n,this.router=m,this.users=[],this.displayedColumns=["username","fullName","email","isActive","actions"]}ngOnInit(){this.loadUsers()}loadUsers(){this.userService.getUsers().subscribe(n=>this.users=n)}addUser(){this.router.navigate(["users","new"])}editUser(n){this.router.navigate(["users",n.id,"edit"])}deleteUser(n){confirm("\xBFSeguro que deseas eliminar este usuario?")&&this.userService.deleteUser(n.id).subscribe(()=>this.loadUsers())}static{this.\u0275fac=function(m){return new(m||e)(c(D),c(M))}}static{this.\u0275cmp=E({type:e,selectors:[["app-user-list"]],standalone:!0,features:[x],decls:29,vars:3,consts:[[1,"spacer"],["mat-raised-button","","color","primary",3,"click"],[1,"table-container"],["mat-table","",1,"mat-elevation-z8",3,"dataSource"],["matColumnDef","username"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","fullName"],["matColumnDef","email"],["matColumnDef","isActive"],["matColumnDef","actions"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["mat-header-cell",""],["mat-cell",""],["color","primary"],["mat-icon-button","","color","primary",3,"click"],["mat-icon-button","","color","warn",3,"click"],["mat-header-row",""],["mat-row",""]],template:function(m,a){m&1&&(i(0,"mat-card")(1,"mat-card-title")(2,"mat-icon"),r(3,"people"),t(),r(4," Usuarios "),p(5,"span",0),i(6,"button",1),_("click",function(){return a.addUser()}),i(7,"mat-icon"),r(8,"person_add"),t(),r(9," Nuevo "),t()(),i(10,"div",2)(11,"table",3),h(12,4),d(13,ye,2,0,"th",5)(14,Ie,2,1,"td",6),C(),h(15,7),d(16,Te,2,0,"th",5)(17,De,2,1,"td",6),C(),h(18,8),d(19,Ne,2,0,"th",5)(20,Fe,2,1,"td",6),C(),h(21,9),d(22,qe,2,0,"th",5)(23,Le,3,1,"td",6),C(),h(24,10),d(25,Re,2,0,"th",5)(26,Ve,7,0,"td",6),C(),d(27,Ae,1,0,"tr",11)(28,ke,1,0,"tr",12),t()()()),m&2&&(o(11),s("dataSource",a.users),o(16),s("matHeaderRowDef",a.displayedColumns),o(),s("matRowDefColumns",a.displayedColumns))},dependencies:[Ce,me,se,ce,de,le,fe,ue,pe,_e,he,T,y,I,b,S,w,U,ee],styles:[".table-container[_ngcontent-%COMP%]{overflow-x:auto;margin-top:1rem}table[_ngcontent-%COMP%]{width:100%;min-width:400px}mat-card[_ngcontent-%COMP%]{margin:2rem auto;max-width:900px}mat-card-title[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.5rem;font-size:1.5rem}.spacer[_ngcontent-%COMP%]{flex:1 1 auto}"]})}}return e})();function Oe(e,l){e&1&&(i(0,"mat-error"),r(1,"Requerido"),t())}function Pe(e,l){e&1&&(i(0,"mat-error"),r(1,"Requerido"),t())}function He(e,l){e&1&&(i(0,"mat-error"),r(1,"Requerido"),t())}function je(e,l){e&1&&(i(0,"mat-error"),r(1,"Email inv\xE1lido"),t())}function Be(e,l){e&1&&(i(0,"mat-error"),r(1,"Requerido"),t())}function $e(e,l){if(e&1&&(i(0,"mat-error"),r(1),t()),e&2){let n=g();o(),f(n.error)}}var q=(()=>{class e{constructor(n,m,a,u){this.fb=n,this.userService=m,this.route=a,this.router=u,this.isEdit=!1,this.userId=null,this.loading=!1,this.error=null,this.form=this.fb.group({username:["",[v.required]],fullName:["",[v.required]],email:["",[v.required,v.email]],password:["",[]],isActive:[!0]})}ngOnInit(){let n=this.route.snapshot.paramMap.get("id");n?(this.isEdit=!0,this.userId=+n,this.loading=!0,this.userService.getUser(this.userId).subscribe({next:m=>{this.form.patchValue({username:m.username,fullName:m.fullName,email:m.email,isActive:m.isActive}),this.form.get("password")?.clearValidators(),this.form.get("password")?.updateValueAndValidity(),this.loading=!1},error:m=>{this.error="No se pudo cargar el usuario",this.loading=!1}})):(this.isEdit=!1,this.form.get("password")?.setValidators([v.required]),this.form.get("password")?.updateValueAndValidity())}save(){if(this.form.invalid)return;this.loading=!0;let n=k({},this.form.value);this.isEdit&&this.userId?(n.password||delete n.password,this.userService.updateUser(this.userId,n).subscribe({next:()=>this.router.navigate(["/users"]),error:m=>{this.error="Error al actualizar usuario",this.loading=!1}})):this.userService.createUser(n).subscribe({next:()=>this.router.navigate(["/users"]),error:m=>{this.error="Error al crear usuario",this.loading=!1}})}cancel(){this.router.navigate(["/users"])}static{this.\u0275fac=function(m){return new(m||e)(c(Y),c(D),c(B),c(M))}}static{this.\u0275cmp=E({type:e,selectors:[["app-user-form"]],standalone:!0,features:[x],decls:43,vars:15,consts:[[3,"ngSubmit","formGroup"],["appearance","outline",1,"full-width"],["matInput","","formControlName","username","required",""],[4,"ngIf"],["matInput","","formControlName","fullName","required",""],["matInput","","formControlName","email","required",""],["matInput","","formControlName","password",3,"type","required"],["formControlName","isActive"],[3,"value"],[1,"actions"],["mat-raised-button","","color","primary","type","submit",3,"disabled"],["mat-button","","type","button",3,"click","disabled"]],template:function(m,a){if(m&1&&(i(0,"mat-card")(1,"mat-card-title")(2,"mat-icon"),r(3),t(),r(4),t(),i(5,"form",0),_("ngSubmit",function(){return a.save()}),i(6,"mat-form-field",1)(7,"mat-label"),r(8,"Usuario"),t(),p(9,"input",2),d(10,Oe,2,0,"mat-error",3),t(),i(11,"mat-form-field",1)(12,"mat-label"),r(13,"Nombre completo"),t(),p(14,"input",4),d(15,Pe,2,0,"mat-error",3),t(),i(16,"mat-form-field",1)(17,"mat-label"),r(18,"Email"),t(),p(19,"input",5),d(20,He,2,0,"mat-error",3)(21,je,2,0,"mat-error",3),t(),i(22,"mat-form-field",1)(23,"mat-label"),r(24,"Contrase\xF1a"),t(),p(25,"input",6),d(26,Be,2,0,"mat-error",3),t(),i(27,"mat-form-field",1)(28,"mat-label"),r(29,"Activo"),t(),i(30,"mat-select",7)(31,"mat-option",8),r(32,"S\xED"),t(),i(33,"mat-option",8),r(34,"No"),t()()(),i(35,"div",9)(36,"button",10)(37,"mat-icon"),r(38,"save"),t(),r(39," Guardar "),t(),i(40,"button",11),_("click",function(){return a.cancel()}),r(41,"Cancelar"),t()(),d(42,$e,2,1,"mat-error",3),t()()),m&2){let u,L,R,V,A;o(3),f(a.isEdit?"edit":"person_add"),o(),P(" ",a.isEdit?"Editar usuario":"Nuevo usuario"," "),o(),s("formGroup",a.form),o(5),s("ngIf",(u=a.form.get("username"))==null?null:u.hasError("required")),o(5),s("ngIf",(L=a.form.get("fullName"))==null?null:L.hasError("required")),o(5),s("ngIf",(R=a.form.get("email"))==null?null:R.hasError("required")),o(),s("ngIf",(V=a.form.get("email"))==null?null:V.hasError("email")),o(4),s("type","password")("required",!a.isEdit),o(),s("ngIf",((A=a.form.get("password"))==null?null:A.hasError("required"))&&!a.isEdit),o(5),s("value",!0),o(2),s("value",!1),o(3),s("disabled",a.form.invalid||a.loading),o(4),s("disabled",a.loading),o(2),s("ngIf",a.error)}},dependencies:[j,H,Z,K,G,z,J,X,Q,W,T,y,I,ne,re,te,ie,oe,ae,w,U,b,S,ge,ve,$],styles:[".full-width[_ngcontent-%COMP%]{width:100%;margin-bottom:1rem}.actions[_ngcontent-%COMP%]{display:flex;gap:1rem;margin-top:1rem}mat-card[_ngcontent-%COMP%]{max-width:500px;margin:2rem auto}mat-card-title[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.5rem;font-size:1.3rem;margin-bottom:1rem}"]})}}return e})();var _t=[{path:"",component:Ee},{path:"new",component:q},{path:":id/edit",component:q}];export{_t as usersRoutes};
